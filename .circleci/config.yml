# definition of circleCI version
version: 2

# define workflow of executions
workflows:
  version: 2
  test:
    jobs:
      - test27
      - test38

jobs:
  test27:
    docker:
      - image: circleci/python:2.7

    # change server dir to repo where we clone down the repo
    working_directory: ~/repo

    steps:
      # download repo
      - checkout

      # install dependencies
      - run:
        name: install dependencies
        command: |
            python -m pip install virtualenv
            python -m virtualenv venv
            . venv/Scripts/activate
            python -m pip install pytest pytest-cov

      # run tests
      - run:
        name: run tests
        command: |
          python -m pytest -v --cov

  test38:
    docker:
      - image: circleci/python:3.8

    # change server dir to repo where we clone down the repo
    working_directory: ~/repo

    steps:
      # download repo
      - checkout

      # install dependencies
      - run:
        name: install dependencies
        command: |
            python -m pip install virtualenv
            python -m virtualenv venv
            . venv/Scripts/activate
            python -m pip install pytest pytest-cov

      # run tests
      - run:
        name: run tests
        command: |
          python -m pytest -v --cov
